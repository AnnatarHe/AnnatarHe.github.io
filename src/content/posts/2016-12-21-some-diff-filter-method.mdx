---
layout: 'post'
title: js æ•°ç»„å»é‡
tags: js array algorithm
date: 2016-12-21
draft: false
---

æœ€è¿‘å†™äº†ä¸€é“æ•°ç»„å»é‡çš„é¢˜ï¼Œæ‰‹æŠ–ï¼Œç´§å¼ ï¼Œæ²¡å†™å¥½ã€‚åæ¥å†™äº†ä¸€ä¼šå„¿è§‰å¾—è¿˜æŒºæœ‰æ„ä¹‰çš„ã€‚ç°åœ¨åšä¸€ä¸‹è®°å½•

## Test case

æµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹

{% highlight js %}

import test from 'ava'
import unique from '../src/unique'

test('[1,1,2] should return [1, 2]', t => {
    t.plan(3)
    const src = [1,1,2]
    const result = unique(src)
    t.is(result.length, 2)
    t.is(result[0], 1)
    t.is(result[1], 2)
})

test('[1, 1, "1"] should return [1, "1"]', t => {
    t.plan(4)
    const src = [1, 1, '1']
    const result = unique(src)
    t.is(result.length, 2)
    t.is(result.indexOf(1), 0)
    t.is(typeof result[1], 'string')
    t.is(result.indexOf('1'), 1)
})

test('deep unique', t => {
    const src = [1, 1, "1", false, false, true, {hello: 'world'}, [1, 2], [1, 2]]
    const result = unique(src)
    t.is(result.length, 6)
})

test('deep unique', t => {
    const src = [1, 1, "1", false, false, true, {hello: 'world'}, [1, 2], [1, 2], {hello: 'world'}]
    const result = unique(src)
    t.is(result.length, 7)
})

{% endhighlight %}

## ç®€å•å»é‡çš„å‡ ç§æ–¹æ³•

æš‚æ—¶å…ˆåªçœ‹æ•°ç»„ä¸­å­˜numberçš„å»é‡æ–¹æ³•ï¼š

æœ€ç²—æš´çš„æ˜¯è¿™ç§ï¼Œåˆ©ç”¨Setä¸èƒ½æœ‰é‡å¤æ•°æ®çš„ç‰¹æ€§åš
{% highlight js %}
const unique = arr => Array.from(new Set(arr))
{% endhighlight %}

æ­£å¸¸æ€è·¯å¦‚ä¸‹ï¼Œç»´æŠ¤ä¸€ä¸ªæš‚å­˜æ•°ç»„ï¼Œå°†æ•°æ®å­˜è¿›å»
{% highlight js %}
function unique(arr) {
    let temp = []
    for (let i = 0; i < arr.length; i++) {
        if (temp.indexOf(arr[i]) === -1) {
            temp.push(arr[i])
        }
    }
    return temp
}
{% endhighlight %}

reduceåšå»é‡(ä¸‹é¢æœ‰å‚è€ƒé“¾æ¥)ï¼Œæ„æ€æ˜¯æ¯æ¬¡å¾€å‰ä¸€ä¸ªæ•°ç»„ä¸­å¡æ•°æ®ï¼Œå…¶å®å°±æ˜¯ä¸Šé¢æ­£å¸¸æ€è·¯çš„å»ä¸­é—´å˜é‡ç‰ˆ
{% highlight js %}
function uniqueByReduce(arr) {
    return arr.reduce((prev, next) => {
        if (prev.indexOf(next) === -1) {
            prev.push(next)
        }
        return prev
    }, [])
}
{% endhighlight %}

è¿™ä¸ªæ—¶å€™åŸºæœ¬intå‹æ•°æ®éƒ½æ²¡ä»€ä¹ˆé—®é¢˜äº†ã€‚

ä½†æ˜¯æˆ‘ä¸Šé¢æµ‹è¯•ç”¨ä¾‹ä¸­æœ€åä¸€ä¸ªç”¨ä¾‹æ˜æ˜¾æ˜¯æ— æ³•é€šè¿‡çš„ã€‚é‚£ä¹ˆå°±éœ€è¦æ›´å¤šçš„åˆ¤æ–­

## æ›´å¤æ‚çš„å»é‡

å…ˆè´´ä»£ç :

{% highlight js %}
function unique(arr) {
    let temp = []
    for (let i = 0; i < arr.length; i++) {
        if (typeof arr[i] === 'object' && (! Array.isArray(arr[i]))) {
            if (! objects.contains(temp, arr[i])) {
                temp.push(arr[i])
            }
        }else if (Array.isArray(arr[i])) {
            if (! arrays.contains(temp, arr[i])) {
                temp.push(arr[i])
            }
        }else {
            if (temp.indexOf(arr[i]) === -1) {
                temp.push(arr[i])
            }
        }
    }
    return temp
}
{% endhighlight %}

æ„æ€æ˜¯åœ¨æ¨è¿›å»çš„æ—¶å€™å¤šåšä¸€äº›åˆ¤æ–­ï¼Œä¸»è¦æ˜¯å¯¹Objectå’ŒArrayçš„åˆ¤å®šã€‚

å…¶ä¸­æœ‰`objects.contains`å’Œ`arrays.contains`ä¸¤ä¸ªæ–¹æ³•åšåˆ¤å®šå·¥ä½œã€‚å…¶å®ç°åˆ†åˆ«å¦‚ä¸‹

{% highlight js %}
// array.js
export function equals(src, dist) {
    if ((! Array.isArray(src)) || (! Array.isArray(dist))) {
        throw new Error('è¯·ä¼ å…¥Arrayå“¦~ğŸ˜ƒ')
    }

    if (src.length !== dist.length) {
        return false
    }

    for (let index = 0; index < src.length; index++) {
        if (Array.isArray(src[index]) && Array.isArray(dist[index])) {
            if (! equals(src[index], dist[index])) {
                return false
            }
        } else {
            if (src[index] !== dist[index]) {
                return false
            }
        }
    }
    return true
}

export function contains(father, child) {
    let flags = []
    father.forEach(item => {
        if (Array.isArray(item)) {
            if (equals(item, child)) {
                flags.push(true)
            }
        }
    })

    return flags.indexOf(true) !== -1
}
{% endhighlight %}

{% highlight js %}
// objects.js
function isPlainObj(obj) {
    return typeof obj === 'object' && (! Array.isArray(obj)) && obj !== null
}

export function equals(obj1, obj2) {
    if (Object.keys(obj1).length !== Object.keys(obj2).length) {
        return false
    }

    for (let item in obj1) {
        // è¿™é‡Œç®€å•åˆ¤æ–­ç®—äº†ï¼Œåé¢å¯ä»¥æ›´å¤æ‚
        if (isPlainObj(obj1[item])) {
            if (isPlainObj(obj2[item])) {
                if (! equals(obj1[item], obj2[item])) {
                    return false
                }
            }else {
                return false
            }
        }else {
            if (obj1[item] !== obj2[item]) {
                return false
            }
        }
    }

    return true
}

export function contains(father, child) {
    for (let key in father) {
        if (isPlainObj(father[key])) {
            // å› ä¸ºåªç»™äº†å€¼ï¼Œæ‰€ä»¥å¾—æœ‰ä¸ªä¸­é—´å±‚
            const tempObj = {
                [key]: father[key]
            }
            if (equals(tempObj, child)) {
                return true
            }
        }
    }
    return false
}

{% endhighlight %}

å…³äºarray.jså’Œobjects.jsçš„æµ‹è¯•ç”¨ä¾‹æˆ‘å°±ä¸ç»™å‡ºäº†ã€‚

åæ­£æœ€åæµ‹è¯•éƒ½é€šè¿‡äº†ï¼Œæ„Ÿè§‰çœŸå¥½~

## References

* [æ•°ç»„å»é‡çš„å‡ ä¸ªæ–¹æ³•](http://www.zhuowenli.com/frontend/array-unique.html)

* [Array.prototype.reduce()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce)
