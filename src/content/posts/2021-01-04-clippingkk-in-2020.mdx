---
title: 📘 ClippingKK 的 2020
tags: clippingkk code side-project 2020
date: 2021-01-04
draft: false
---

# ClippingKK in 2020

2020 是个变化之年。不仅世界在变，作为独立个人的我也产生了很多很多的变化。

一个是工作方面，在 2020 年初我换了份工作，新的公司对我产生了非常多正面积极的影响（或许是和之前的生活有过于鲜明的对比）。

产生的众多变化在 ClippingKK 中得以体现。往年我的 github contributions 一直在 400 - 500 左右，今年则超过了 1000 条。

其中后端的年度 commits 为：

| 年份 | 前端 Commits | 后端 Commits |
|------|--------------|--------------|
| 2020 | 227          | 169          |
| 2019 | 75           | 56           |
| 2018 | 8            | 55           |

命令：

```bash
git log --pretty='format:%cd' --date=format:'%Y' | uniq -c | awk '{print "Year: "$2", commits: "$1}’
```

今年由于 iOS 14 的发布带来了 iOS widget 所以也新发布了 [iOS 版本](https://apps.apple.com/us/app/clippingkk/id1537830952) 主要提供桌面的 widget

## 大事件

今年最大的事情是终于有了更多的时间去做更多的开发和思考，所以今年的代码量增长相较于之前多了不少。最为瞩目的是对整个后端接口的重构，将原有的 RESTful 接口替换为了 GraphQL，在开发体验上有了非常大的提升。

Q3 接触到 iOS 14 的 widgets 确实非常不错，再加上那段时间对 Flutter 性能过于失望。两种情绪交织在一起就开发了 SwiftUI 版的 iOS app 上架 App Store。可惜的是 SwiftUI 依旧是个半成品，没能影响到我的吐槽功力

年中的时候由于豆瓣的反爬虫策略变化，索性新开服务把豆瓣数据拉到本地。

## 今年的 Features

### 重构 - GraphQL

之前由于快速开发，后端还有前端交互是使用 restful 接口。今年准备好好做，花了大力气迁移到了 GraphQL 接口。

### wenqu

年中由于豆瓣对 client_id 的收回导致取书的脚本不可用，和 [书伴作者](https://www.coolapk.com/apk/com.merpyzf.xmnote) 一起搞了这个服务，本质上就是一个爬虫，把数据同步到本地，然后作为 web 服务暴露出去，

### iOS app

就像上面说的，我觉得 iOS widget 机会特别大，很有意思，所以忍痛买了苹果开发者证书，发布了一个版本出去。app 做得挺差劲，但是主要是 widget，后面会多花点儿力气搞这个版本

说起来 SwiftUI 写着挺扯的，第二个大版本了，依旧是要啥啥没有，然后 bug 到处飞的情况。我的 Mac Mini 打开 XCode 不能展示 Assets 你敢信。还有什么 onAppear 在一些手机上不触发，LazyVStack 自动回收 scroll 的问题等。写 iOS 太气人了，搞得有时候都想掏出 UIKit 写。

### 微信小程序

今年上半年的时候对小程序进行了很大的改变，做了大的升级，样式调整之类的。这个平台相对来说还是比较全面的，算是一个主力平台。（其实很大程度上是因为我比较会写小程序 😂）

然后用户记录的大头基本上是通过分享出去的二维码扫进来的朋友。果然微信流量巨大。

当然还有其他很多的 feature，我简单摘抄一些 changelog 的东西:

- web 及 iOS 版支持 dark theme
- 添加搜索功能
- web 版本升级 webpack 5, fast-refreash 等
- 新增 “评论” 功能 （这个功能门槛比较高）
- 增加月度和年度报告功能
- 国际化支持（中文，英文）
- web 部署迁移到了腾讯云开发上了，类似 vercel 的 edge computing
- 书摘支持隐藏
- 书摘广场开放
- 管理员页面加入未分类数据整理功能，其实就是我没事了打开看一下哪些书没分类，帮忙分一下
- 优化登录注册
- 新增数据打点（没有个人信息，纯粹看 pv,uv 的）
- 优化分享图的生成
- 等等...

至于 bugfix 就不说了，实在太多

### 评论

功能中有几个值得多谈谈的点，其中一个我比较重视的是评论。在 2020 年开发了这个功能，并发布到了线上，现在 web 可以使用这个功能。
但是这个功能有一个很高的门槛：至少 40 字的内容。加入这个限制能猜想到也许只有很少的人愿意去写评论内容，只是没想到到今天为止，一条评论也没有 😭
这个功能我一直很

### 反应

reaction

### iOS widget

### 国际化

## 其他

### 营销

去年说好要做营销的，但还是没能做出什么比较好的营销策略，只是开发了一些可以营销的功能，像是书摘分享，年度报告。

社交平台上依旧没能做起来。现在发现知乎很可能是个不错的流量来源。只是我个人又不太喜欢知乎这种节奏怎么办呢。😶

今年尝试了做视频推广。上半年还不错，加了大概五十个用户左右。下半年末期在 [即刻](https://web.okjike.com/u/20965c29-1f92-4df8-9107-45043db29278) 做推广, 效果很差几乎没有新增

### 设计

今年在 web 上终于有了一些设计上的优化，加多了渐变色及 blur 的应用。得益于 tailwindcss 的 design pattern，界面总算统一了一些。感兴趣的朋友可以去网站上看一看。

但是 iOS 的设计确实是非常差劲，几乎没有设计就只是平铺出内容而已。后面再看看要怎么调整。倒是 widgets 我还挺喜欢的，感觉样式还不错

![ios-widget](/dist/2021-01-04-clippingkk-ios-widget.png)

### 成本

由于和另一个项目交织在一起，单独算这个项目的成本不是太容易，索性多说一些算一下整体开支。

服务器目前是两台，一台部署了杂七杂八以及开发机的服务，之前低价买的百度云。一年 252 RMB，然后这台服务器域名花了 25 RMB。第二台服务器是主要服务，部署在腾讯云，最开始买的机器两年 850，真的巨贵，今年换到了 116 每年，成本终于低下来很多。可喜可贺。这里还有个主域名懒得找数据了，也是比较便宜的价格。

其实还有一项在 CDN 上，这个服务占有 40G 的存储空间，由于和另一个服务账单在一起，算不出来了。反正总共每月 150 RMB 上下。非常非常贵。

说到这里，我其实一直想写一份穷人怎么开发 app 的攻略。在做项目的期间我觉得找到了各种省钱妙招，比如把 node 服务换成 golang 可以省一大部分计算能力，拿免费的 newrelic 做性能监控，sentry 做报警，七牛免费 10G 存储, vercel 免费部署等。

靠爱发电好难。

## 展望 2021

其实我考虑的首先不是 app 怎么做，怎么盈利，界面设计怎么优化什么的。而是成本怎么控制，这个项目做到第三年，还越来越亏钱，如果不是我自己需要，它早就没了，明年如果亏钱的空间再加大可能会把一些花销大的功能砍掉了。

还有一点是可能考虑加多 iOS app 的功能，然后靠卖 app 试试能不能把基本的成本拉回来一点点。目前的 web 功能是绝对够的，但是 app 还太缺（啊，swiftUI 好垃圾啊！我要怎么接着写）

关于后端我大概率还是不会考虑性能问题，用户量太小远没有达到需要顾虑的程度

国际化其实是我考虑中很重视的一个点，目前也支持了中英韩语，但是苦于运营难度比较大，到现在也没有一个外语用户，哎。

关于项目其他的计划，也还没很仔细地想清楚，走一步算一步吧。

这篇文章不会特意转发到社交平台上，希望能看到的朋友可以 Happy Reading. 灵魂强大起来.

